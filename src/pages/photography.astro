<!--
  photography.astro
  
  Photography portfolio page displaying Colin's architectural and landscape photography.
  Features photo albums, lightbox galleries, and image optimization.
  Showcases work from various locations with responsive gallery layouts.
-->

---
import PageLayout from '../layouts/PageLayout.astro';

// Photo album data structure
const photoAlbums = [
  {
    id: 'florida-southern-25',
    title: 'Florida Southern `25',
    description: 'Frank Lloyd Wright architecture, Lakeland, Florida, 2025',
    coverImage: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083583/IMG_0754_freaxp.jpg',
    images: [
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083583/IMG_0754_freaxp.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083582/IMG_0765_khnc0a.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083582/IMG_0798_msc1wp.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083581/IMG_0776_urqqeo.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083581/IMG_0759_ydhbb5.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083581/IMG_0793_j53sdd.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083580/IMG_0796_hnzsrk.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083579/IMG_0753_cbbfbp.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083579/IMG_0778_tp4prx.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083579/IMG_0756_mkwxj5.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083578/IMG_0746_jwhltx.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083578/IMG_0757_baoqix.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
    ]
  },
  {
    id: 'montreal-23',
    title: 'Montreal `23',
    description: 'Street photography and urban exploration in Montreal, 2023',
    coverImage: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084164/BBB03850_eercan.jpg',
    images: [
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084164/BBB03850_eercan.jpg',
        alt: 'Montreal Street Scene',
        title: 'Urban Life',
        camera: 'Sony A7sii',
        year: '2023'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084095/BBB04065_qy1rg7.jpg',
        alt: 'Montreal Street Scene',
        title: 'Urban Life',
        camera: 'Sony A7sii',
        year: '2023'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084237/BBB03997_i81zit.jpg',
        alt: 'Montreal Street Scene',
        title: 'Urban Life',
        camera: 'Sony A7sii',
        year: '2023'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084229/BBB04020_i2vzdj.jpg',
        alt: 'Montreal Street Scene',
        title: 'Urban Life',
        camera: 'Sony A7sii',
        year: '2023'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084168/BBB04002_rayg3u.jpg',
        alt: 'Montreal Street Scene',
        title: 'Urban Life',
        camera: 'Sony A7sii',
        year: '2023'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084125/BBB03846_ugsbpx.jpg',
        alt: 'Montreal Street Scene',
        title: 'Urban Life',
        camera: 'Sony A7sii',
        year: '2023'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084116/BBB03900_wniatk.jpg',
        alt: 'Montreal Street Scene',
        title: 'Urban Life',
        camera: 'Sony A7sii',
        year: '2023'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084106/BBB03956_dafhvt.jpg',
        alt: 'Montreal Street Scene',
        title: 'Urban Life',
        camera: 'Sony A7sii',
        year: '2023'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084103/BBB03985_h1symv.jpg',
        alt: 'Montreal Street Scene',
        title: 'Urban Life',
        camera: 'Sony A7sii',
        year: '2023'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084099/BBB03978_zqyrnz.jpg',
        alt: 'Montreal Street Scene',
        title: 'Urban Life',
        camera: 'Sony A7sii',
        year: '2023'
      },
    ]
  },
  {
    id: 'sitka-alaska-22',
    title: 'Sitka `22',
    description: 'Natural landscapes and wildlife photography in Sitka, Alaska, 2022',
    coverImage: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084039/eagle_xtbz5s.jpg',
    images: [
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084039/eagle_xtbz5s.jpg',
        alt: 'Alaskan Wilderness',
        title: 'Sitka Landscape',
        camera: 'Olympus OM-10',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084042/mountain_o5ihww.jpg',
        alt: 'Alaskan Wilderness',
        title: 'Sitka Landscape',
        camera: 'Olympus OM-10',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084040/plane_mprfwx.jpg',
        alt: 'Alaskan Wilderness',
        title: 'Sitka Landscape',
        camera: 'Olympus OM-10',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084042/swing_t3gqza.jpg',
        alt: 'Alaskan Wilderness',
        title: 'Sitka Landscape',
        camera: 'Olympus OM-10',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084041/church_qfp4gr.jpg',
        alt: 'Alaskan Wilderness',
        title: 'Sitka Landscape',
        camera: 'Olympus OM-10',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084040/flowers_urnvat.jpg',
        alt: 'Alaskan Wilderness',
        title: 'Sitka Landscape',
        camera: 'Olympus OM-10',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084039/mountains_w0nbwa.jpg',
        alt: 'Alaskan Wilderness',
        title: 'Sitka Landscape',
        camera: 'Olympus OM-10',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084039/weathervane_ilyok5.jpg',
        alt: 'Alaskan Wilderness',
        title: 'Sitka Landscape',
        camera: 'Olympus OM-10',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084038/bench_kf3ev8.jpg',
        alt: 'Alaskan Wilderness',
        title: 'Sitka Landscape',
        camera: 'Olympus OM-10',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084038/houses_kbj1an.jpg',
        alt: 'Alaskan Wilderness',
        title: 'Sitka Landscape',
        camera: 'Olympus OM-10',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084038/totem_mu554u.jpg',
        alt: 'Alaskan Wilderness',
        title: 'Sitka Landscape',
        camera: 'Olympus OM-10',
        year: '2022'
      },
    ]
  },
  {
    id: 'nampa-idaho-22',
    title: 'Nampa `22',
    description: 'Street and landscape film photography in Nampa, Idaho, 2022',
    coverImage: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083994/AA008_s5bipu.jpg',
    images: [
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083994/AA008_s5bipu.jpg',
        alt: 'Nampa, Idaho',
        title: 'Idahoan Scene',
        camera: 'Leica m3',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083996/train_gqnckn.jpg',
        alt: 'Nampa, Idaho',
        title: 'Idahoan Scene',
        camera: 'Leica m3',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083994/mailman_kwv71i.jpg',
        alt: 'Nampa, Idaho',
        title: 'Idahoan Scene',
        camera: 'Leica m3',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083994/house_hy3u25.jpg',
        alt: 'Nampa, Idaho',
        title: 'Idahoan Scene',
        camera: 'Leica m3',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084056/pottery_aqlyg7.jpg',
        alt: 'Nampa, Idaho',
        title: 'Idahoan Scene',
        camera: 'Leica m3',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083995/farmland_gcotwa.jpg',
        alt: 'Nampa, Idaho',
        title: 'Idahoan Scene',
        camera: 'Leica m3',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083995/traffic_cjqzif.jpg',
        alt: 'Nampa, Idaho',
        title: 'Idahoan Scene',
        camera: 'Leica m3',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083994/lounge_qiylxa.jpg',
        alt: 'Nampa, Idaho',
        title: 'Idahoan Scene',
        camera: 'Leica m3',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083994/tiny_s_qecook.jpg',
        alt: 'Nampa, Idaho',
        title: 'Idahoan Scene',
        camera: 'Leica m3',
        year: '2022'
      },
    ]
  }
];
---

<PageLayout title="Photography - Colin Raab" description="Explore Colin's photography.">
  <section class="section">
    <div class="container">
      <div class="page-hero">
        <h1>Photography</h1>
        <p class="lead">
          Architecture, landscape, and street photography.
        </p>
      </div>
      
      <div class="albums-grid">
        {photoAlbums.map((album) => (
          <div class="album-card" data-album-id={album.id}>
            <div class="album-cover">
              <img src={album.coverImage} alt={album.title} loading="lazy" />
              <div class="album-overlay">
                <h3>{album.title}</h3>
                <p>{album.description}</p>
                <div class="image-count">{album.images.length} images</div>
              </div>
            </div>
            <div class="album-info">
              <h3>{album.title}</h3>
              <p>{album.description}</p>
            </div>
          </div>
        ))}
      </div>
      
      <!-- Full-screen gallery modal -->
      <div class="gallery-modal" id="galleryModal">
        <div class="gallery-container">
          <div class="gallery-header">
            <button class="close-btn" id="closeGallery">&times;</button>
          </div>
          
          <div class="gallery-main">
            <button class="nav-btn prev-btn" id="prevImage">&#8249;</button>
            <div class="main-image-container">
              <img class="main-image" id="mainImage" alt="" />
            </div>
            <button class="nav-btn next-btn" id="nextImage">&#8250;</button>
          </div>
          
          <div class="gallery-thumbnails">
            <div class="thumbnails-container" id="thumbnailsContainer">
              <!-- Thumbnails will be populated by JavaScript -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</PageLayout>

<style lang="scss">
  @use '../styles/helpers/responsive' as *;
  @use '../styles/helpers/colors' as *;
  @use '../styles/helpers/fonts' as *;
  @use '../styles/helpers/grid' as *;

  .page-hero {
    text-align: center;
    margin-bottom: 3rem;
    
    h1 {
      @include font-size('5xl');
      margin-bottom: 1rem;
      
      @include media-down('sm') {
        @include font-size('4xl');
      }
    }
    
    .lead {
      @include font-size('xl');
      @include text-color('text-secondary');
      max-width: 600px;
      margin: 0 auto;
    }
  }

  // Album Grid Styles
  .albums-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 2rem;
    margin-bottom: 6rem;
    
    @include media-down('md') {
      grid-template-columns: 1fr;
      gap: 1.5rem;
      margin-bottom: 4rem;
    }
  }

  .album-card {
    @include bg-color('bg-secondary');
    border: 1px solid var(--color-border);
    border-radius: 12px;
    overflow: hidden;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    cursor: pointer;
    
    &:hover {
      transform: translateY(-8px);
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.15);
      
      .album-overlay {
        opacity: 1;
      }
      
      img {
        transform: scale(1.05);
      }
    }
  }

  .album-cover {
    height: 280px;
    position: relative;
    overflow: hidden;
    
    img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s ease;
    }
  }

  .album-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.5));
    color: white;
    @include flex-center;
    flex-direction: column;
    text-align: center;
    opacity: 0;
    transition: opacity 0.3s ease;
    padding: 2rem;
    
    h3 {
      @include font-size('xl');
      @include font-weight('bold');
      margin-bottom: 0.5rem;
    }
    
    p {
      @include font-size('sm');
      margin-bottom: 1rem;
      line-height: 1.4;
    }
    
    .image-count {
      @include font-size('xs');
      @include font-weight('medium');
      padding: 0.25rem 0.75rem;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 15px;
      backdrop-filter: blur(10px);
    }
  }

  .album-info {
    padding: 1.5rem;
    
    h3 {
      @include font-size('lg');
      @include font-weight('semibold');
      margin-bottom: 0.5rem;
      @include text-color('text-primary');
    }
    
    p {
      @include font-size('sm');
      @include text-color('text-secondary');
      line-height: 1.5;
    }
  }

  // Gallery Modal Styles
  .gallery-modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.95);
    z-index: 1000;
    display: none;
    overflow: hidden;
    
    &.active {
      display: flex;
      align-items: center;
      justify-content: center;
    }
  }

  .gallery-container {
    width: 100%;
    height: 100vh;
    max-height: 100vh;
    display: flex;
    flex-direction: column;
    max-width: 1400px;
    margin: 0 auto;
    padding: 1rem;
    overflow: hidden; // Prevent container overflow
    
    @include media-down('sm') {
      padding: 0.5rem;
    }
  }

  .gallery-header {
    position: absolute;
    top: 0;
    right: 0;
    padding: 1rem;
    z-index: 100;
    background: none;
    border: none;
    
    .close-btn {
      background: rgba(0, 0, 0, 0.7);
      border: none;
      color: white;
      @include font-size('2xl');
      cursor: pointer;
      padding: 0.5rem;
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: all 0.2s ease;
      backdrop-filter: blur(10px);
      
      &:hover {
        background: rgba(0, 0, 0, 0.9);
        transform: scale(1.1);
      }
    }
  }

  .gallery-main {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    min-height: 0;
    padding: 2rem 1rem 1rem 1rem;
    height: calc(100vh - 120px); // Account for thumbnails space
    max-height: calc(100vh - 120px);
    overflow: hidden; // Prevent content from overflowing
  }

  .nav-btn {
    background: rgba(255, 255, 255, 0.1);
    border: none;
    color: white;
    @include font-size('2xl');
    padding: 1rem;
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.2s ease;
    backdrop-filter: blur(10px);
    width: 60px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    
    &:hover {
      background: rgba(255, 255, 255, 0.2);
      transform: scale(1.1);
    }
    
    &:disabled {
      opacity: 0.3;
      cursor: not-allowed;
      
      &:hover {
        transform: none;
        background: rgba(255, 255, 255, 0.1);
      }
    }
    
    @include media-down('md') {
      display: none; // Hide navigation arrows on mobile/tablet
    }
  }

  .main-image-container {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    max-height: 100%;
    min-height: 0;
    position: relative;
    width: 100%;
    overflow: hidden; // Prevent image from overflowing container
    
    @include media-down('md') {
      // Add touch area and user select prevention for better mobile experience
      user-select: none;
      -webkit-user-select: none;
      -webkit-touch-callout: none;
      
      // Add subtle visual hint for swipe on mobile
      &::after {
        content: 'Swipe to navigate';
        position: absolute;
        bottom: 0.5rem;
        left: 50%;
        transform: translateX(-50%);
        color: rgba(255, 255, 255, 0.6);
        @include font-size('xs');
        pointer-events: none;
        opacity: 0;
        animation: fadeInOut 3s ease-in-out;
        animation-delay: 1s;
      }
    }
  }
  
  @keyframes fadeInOut {
    0%, 100% { opacity: 0; }
    50% { opacity: 1; }
  }

  .main-image {
    max-width: 100%;
    max-height: 100%; // Constrain to container height instead of viewport
    width: auto;
    height: auto;
    object-fit: contain;
    border-radius: 8px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    display: block; // Ensure proper display
    
    @include media-down('sm') {
      max-height: 100%; // Use container constraints on mobile too
    }
  }

  .gallery-thumbnails {
    padding: 2rem 0 1rem 0; // Increased top padding to ensure gap
    margin-top: 1rem; // Additional margin for spacing
  }

  .thumbnails-container {
    display: flex;
    gap: 0.5rem;
    overflow-x: auto;
    padding: 0.5rem 0;
    scrollbar-width: thin;
    scrollbar-color: rgba(255, 255, 255, 0.3) transparent;
    
    &::-webkit-scrollbar {
      height: 6px;
    }
    
    &::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 3px;
    }
    
    &::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.3);
      border-radius: 3px;
      
      &:hover {
        background: rgba(255, 255, 255, 0.5);
      }
    }
  }

  .thumbnail {
    flex-shrink: 0;
    width: 80px;
    height: 80px;
    border-radius: 4px;
    overflow: hidden;
    cursor: pointer;
    border: 2px solid transparent;
    transition: border-color 0.2s ease, transform 0.2s ease;
    
    img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    &.active {
      border-color: var(--color-primary, #fff);
    }
    
    &:hover {
      transform: scale(1.1);
      border-color: rgba(255, 255, 255, 0.5);
    }
    
    @include media-down('sm') {
      width: 60px;
      height: 60px;
    }
  }
</style>

<script is:inline>
// Photo Gallery JavaScript - Using inline script for view transitions compatibility

// Photo albums data - embedded directly to work with view transitions
const photoAlbumsData = [
  {
    id: 'florida-southern-25',
    title: 'Florida Southern `25',
    description: 'Frank Lloyd Wright architecture, Lakeland, Florida, 2025',
    coverImage: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083583/IMG_0754_freaxp.jpg',
    images: [
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083583/IMG_0754_freaxp.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083582/IMG_0765_khnc0a.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083582/IMG_0798_msc1wp.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083581/IMG_0776_urqqeo.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083581/IMG_0759_ydhbb5.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083581/IMG_0793_j53sdd.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083580/IMG_0796_hnzsrk.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083579/IMG_0753_cbbfbp.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083579/IMG_0778_tp4prx.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083579/IMG_0756_mkwxj5.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083578/IMG_0746_jwhltx.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083578/IMG_0757_baoqix.jpg',
        alt: 'Florida Southern Campus',
        title: 'Chldren of the Sun',
        camera: 'Canon R10',
        lens: '18-45mm f/4.5-6.3',
        year: '2025'
      },
    ]
  },
  {
    id: 'montreal-23',
    title: 'Montreal `23',
    description: 'Street photography and urban exploration in Montreal, 2023',
    coverImage: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084164/BBB03850_eercan.jpg',
    images: [
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084164/BBB03850_eercan.jpg',
        alt: 'Montreal Street Scene',
        title: 'Urban Life',
        camera: 'Sony A7sii',
        year: '2023'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084095/BBB04065_qy1rg7.jpg',
        alt: 'Montreal Street Scene',
        title: 'Urban Life',
        camera: 'Sony A7sii',
        year: '2023'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084237/BBB03997_i81zit.jpg',
        alt: 'Montreal Street Scene',
        title: 'Urban Life',
        camera: 'Sony A7sii',
        year: '2023'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084229/BBB04020_i2vzdj.jpg',
        alt: 'Montreal Street Scene',
        title: 'Urban Life',
        camera: 'Sony A7sii',
        year: '2023'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084168/BBB04002_rayg3u.jpg',
        alt: 'Montreal Street Scene',
        title: 'Urban Life',
        camera: 'Sony A7sii',
        year: '2023'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084125/BBB03846_ugsbpx.jpg',
        alt: 'Montreal Street Scene',
        title: 'Urban Life',
        camera: 'Sony A7sii',
        year: '2023'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084116/BBB03900_wniatk.jpg',
        alt: 'Montreal Street Scene',
        title: 'Urban Life',
        camera: 'Sony A7sii',
        year: '2023'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084106/BBB03956_dafhvt.jpg',
        alt: 'Montreal Street Scene',
        title: 'Urban Life',
        camera: 'Sony A7sii',
        year: '2023'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084103/BBB03985_h1symv.jpg',
        alt: 'Montreal Street Scene',
        title: 'Urban Life',
        camera: 'Sony A7sii',
        year: '2023'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084099/BBB03978_zqyrnz.jpg',
        alt: 'Montreal Street Scene',
        title: 'Urban Life',
        camera: 'Sony A7sii',
        year: '2023'
      },
    ]
  },
  {
    id: 'sitka-alaska-22',
    title: 'Sitka `22',
    description: 'Natural landscapes and wildlife photography in Sitka, Alaska, 2022',
    coverImage: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084039/eagle_xtbz5s.jpg',
    images: [
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084039/eagle_xtbz5s.jpg',
        alt: 'Alaskan Wilderness',
        title: 'Sitka Landscape',
        camera: 'Olympus OM-10',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084042/mountain_o5ihww.jpg',
        alt: 'Alaskan Wilderness',
        title: 'Sitka Landscape',
        camera: 'Olympus OM-10',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084040/plane_mprfwx.jpg',
        alt: 'Alaskan Wilderness',
        title: 'Sitka Landscape',
        camera: 'Olympus OM-10',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084042/swing_t3gqza.jpg',
        alt: 'Alaskan Wilderness',
        title: 'Sitka Landscape',
        camera: 'Olympus OM-10',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084041/church_qfp4gr.jpg',
        alt: 'Alaskan Wilderness',
        title: 'Sitka Landscape',
        camera: 'Olympus OM-10',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084040/flowers_urnvat.jpg',
        alt: 'Alaskan Wilderness',
        title: 'Sitka Landscape',
        camera: 'Olympus OM-10',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084039/mountains_w0nbwa.jpg',
        alt: 'Alaskan Wilderness',
        title: 'Sitka Landscape',
        camera: 'Olympus OM-10',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084039/weathervane_ilyok5.jpg',
        alt: 'Alaskan Wilderness',
        title: 'Sitka Landscape',
        camera: 'Olympus OM-10',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084038/bench_kf3ev8.jpg',
        alt: 'Alaskan Wilderness',
        title: 'Sitka Landscape',
        camera: 'Olympus OM-10',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084038/houses_kbj1an.jpg',
        alt: 'Alaskan Wilderness',
        title: 'Sitka Landscape',
        camera: 'Olympus OM-10',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084038/totem_mu554u.jpg',
        alt: 'Alaskan Wilderness',
        title: 'Sitka Landscape',
        camera: 'Olympus OM-10',
        year: '2022'
      },
    ]
  },
  {
    id: 'nampa-idaho-22',
    title: 'Nampa `22',
    description: 'Street and landscape film photography in Nampa, Idaho, 2022',
    coverImage: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083994/AA008_s5bipu.jpg',
    images: [
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083994/AA008_s5bipu.jpg',
        alt: 'Nampa, Idaho',
        title: 'Idahoan Scene',
        camera: 'Leica m3',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083996/train_gqnckn.jpg',
        alt: 'Nampa, Idaho',
        title: 'Idahoan Scene',
        camera: 'Leica m3',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083994/mailman_kwv71i.jpg',
        alt: 'Nampa, Idaho',
        title: 'Idahoan Scene',
        camera: 'Leica m3',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083994/house_hy3u25.jpg',
        alt: 'Nampa, Idaho',
        title: 'Idahoan Scene',
        camera: 'Leica m3',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754084056/pottery_aqlyg7.jpg',
        alt: 'Nampa, Idaho',
        title: 'Idahoan Scene',
        camera: 'Leica m3',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083995/farmland_gcotwa.jpg',
        alt: 'Nampa, Idaho',
        title: 'Idahoan Scene',
        camera: 'Leica m3',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083995/traffic_cjqzif.jpg',
        alt: 'Nampa, Idaho',
        title: 'Idahoan Scene',
        camera: 'Leica m3',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083994/lounge_qiylxa.jpg',
        alt: 'Nampa, Idaho',
        title: 'Idahoan Scene',
        camera: 'Leica m3',
        year: '2022'
      },
      {
        src: 'https://res.cloudinary.com/dn8qfu68i/image/upload/v1754083994/tiny_s_qecook.jpg',
        alt: 'Nampa, Idaho',
        title: 'Idahoan Scene',
        camera: 'Leica m3',
        year: '2022'
      },
    ]
  }
];

// Gallery state variables
let currentAlbum = null;
let currentImageIndex = 0;
let modal = null;

function setupPhotoGallery() {
  // Only setup if we're on the photography page and have album cards
  const isPhotographyPage = window.location.pathname.includes('photography') || 
                            window.location.pathname.endsWith('/photography');
  const albumCards = document.querySelectorAll('.album-card');
  
  if (!isPhotographyPage || albumCards.length === 0) {
    return;
  }
  
  // Setup album card click handlers
  albumCards.forEach(card => {
    // Remove any existing handler to prevent duplicates
    card.removeEventListener('click', card.albumClickHandler);
    
    // Create and store the handler on the element
    card.albumClickHandler = function() {
      const albumId = this.dataset.albumId;
      if (albumId) {
        openAlbum(albumId);
      }
    };
    
    // Add the event listener
    card.addEventListener('click', card.albumClickHandler);
  });
  
  // Setup modal controls
  setupModalControls();
  
  // Setup keyboard navigation
  setupKeyboardNavigation();
  
  // Setup touch/swipe navigation for mobile
  setupTouchNavigation();
}

function setupModalControls() {
  modal = document.getElementById('galleryModal');
  if (!modal) return;
  
  const closeBtn = document.getElementById('closeGallery');
  const prevBtn = document.getElementById('prevImage');
  const nextBtn = document.getElementById('nextImage');
  
  // Remove existing handlers to prevent duplicates
  if (closeBtn) {
    closeBtn.removeEventListener('click', closeBtn.galleryCloseHandler);
    closeBtn.galleryCloseHandler = () => closeGallery();
    closeBtn.addEventListener('click', closeBtn.galleryCloseHandler);
  }
  
  if (prevBtn) {
    prevBtn.removeEventListener('click', prevBtn.galleryPrevHandler);
    prevBtn.galleryPrevHandler = () => previousImage();
    prevBtn.addEventListener('click', prevBtn.galleryPrevHandler);
  }
  
  if (nextBtn) {
    nextBtn.removeEventListener('click', nextBtn.galleryNextHandler);
    nextBtn.galleryNextHandler = () => nextImage();
    nextBtn.addEventListener('click', nextBtn.galleryNextHandler);
  }
  
  // Modal background click
  modal.removeEventListener('click', modal.galleryBackgroundHandler);
  modal.galleryBackgroundHandler = function(e) {
    if (e.target === modal) {
      closeGallery();
    }
  };
  modal.addEventListener('click', modal.galleryBackgroundHandler);
}

function setupKeyboardNavigation() {
  // Remove existing global keyboard handler to prevent duplicates
  document.removeEventListener('keydown', document.galleryKeyHandler);
  
  document.galleryKeyHandler = function(e) {
    if (!modal || !modal.classList.contains('active')) return;
    
    switch(e.key) {
      case 'Escape':
        closeGallery();
        break;
      case 'ArrowLeft':
        previousImage();
        break;
      case 'ArrowRight':
        nextImage();
        break;
    }
  };
  
  document.addEventListener('keydown', document.galleryKeyHandler);
}

function setupTouchNavigation() {
  // Remove existing touch handlers to prevent duplicates
  document.removeEventListener('touchstart', document.galleryTouchStartHandler);
  document.removeEventListener('touchend', document.galleryTouchEndHandler);
  
  let touchStartX = null;
  let touchStartY = null;
  const minSwipeDistance = 50; // Minimum distance for a swipe
  const maxVerticalDistance = 100; // Maximum vertical movement to still count as horizontal swipe
  
  document.galleryTouchStartHandler = function(e) {
    // Only handle touches when gallery is open and on the main image area
    if (!modal || !modal.classList.contains('active')) return;
    
    const mainImageContainer = document.querySelector('.main-image-container');
    const mainImage = document.querySelector('.main-image');
    const target = e.target;
    
    // Only handle touches on the main image or its container
    if (!mainImageContainer.contains(target) && target !== mainImage) return;
    
    const touch = e.touches[0];
    touchStartX = touch.clientX;
    touchStartY = touch.clientY;
  };
  
  document.galleryTouchEndHandler = function(e) {
    // Only handle touches when gallery is open
    if (!modal || !modal.classList.contains('active')) return;
    if (touchStartX === null || touchStartY === null) return;
    
    const mainImageContainer = document.querySelector('.main-image-container');
    const mainImage = document.querySelector('.main-image');
    const target = e.target;
    
    // Only handle touches on the main image or its container
    if (!mainImageContainer.contains(target) && target !== mainImage) return;
    
    const touch = e.changedTouches[0];
    const touchEndX = touch.clientX;
    const touchEndY = touch.clientY;
    
    const deltaX = touchEndX - touchStartX;
    const deltaY = Math.abs(touchEndY - touchStartY);
    
    // Reset touch coordinates
    touchStartX = null;
    touchStartY = null;
    
    // Check if this was a horizontal swipe (not too much vertical movement)
    if (deltaY > maxVerticalDistance) return;
    
    // Check if swipe distance is sufficient
    if (Math.abs(deltaX) < minSwipeDistance) return;
    
    // Determine swipe direction and navigate
    if (deltaX > 0) {
      // Swipe right - go to previous image
      previousImage();
    } else {
      // Swipe left - go to next image
      nextImage();
    }
  };
  
  document.addEventListener('touchstart', document.galleryTouchStartHandler, { passive: true });
  document.addEventListener('touchend', document.galleryTouchEndHandler, { passive: true });
}

function openAlbum(albumId) {
  currentAlbum = photoAlbumsData.find(album => album.id === albumId);
  if (!currentAlbum || !modal) return;
  
  currentImageIndex = 0;
  modal.classList.add('active');
  document.body.style.overflow = 'hidden';
  
  updateGalleryContent();
  createThumbnails();
}

function closeGallery() {
  if (modal) {
    modal.classList.remove('active');
  }
  document.body.style.overflow = '';
  currentAlbum = null;
}

function updateGalleryContent() {
  if (!currentAlbum) return;
  
  const currentImage = currentAlbum.images[currentImageIndex];
  
  // Update title
  const galleryTitle = document.querySelector('.gallery-title');
  if (galleryTitle) {
    galleryTitle.textContent = currentAlbum.title;
  }
  
  // Update main image
  const mainImage = document.getElementById('mainImage');
  if (mainImage) {
    mainImage.src = currentImage.src;
    mainImage.alt = currentImage.alt;
  }
  
  // Update image info
  const imageTitle = document.querySelector('.image-title');
  const imageDescription = document.querySelector('.image-description');
  const metaCamera = document.querySelector('.meta-camera');
  const metaLens = document.querySelector('.meta-lens');
  const metaYear = document.querySelector('.meta-year');
  
  if (imageTitle) imageTitle.textContent = currentImage.title;
  if (imageDescription) imageDescription.textContent = currentImage.description;
  if (metaCamera) metaCamera.textContent = currentImage.camera;
  if (metaLens) metaLens.textContent = currentImage.lens || '';
  if (metaYear) metaYear.textContent = currentImage.year;
  
  // Update navigation buttons
  const prevBtn = document.getElementById('prevImage');
  const nextBtn = document.getElementById('nextImage');
  
  if (prevBtn) {
    prevBtn.disabled = currentImageIndex === 0;
  }
  if (nextBtn) {
    nextBtn.disabled = currentImageIndex === currentAlbum.images.length - 1;
  }
  
  // Update thumbnails
  updateThumbnailActive();
}

function createThumbnails() {
  const container = document.getElementById('thumbnailsContainer');
  if (!container || !currentAlbum) return;
  
  container.innerHTML = '';
  
  currentAlbum.images.forEach((image, index) => {
    const thumbnail = document.createElement('div');
    thumbnail.className = 'thumbnail';
    if (index === currentImageIndex) {
      thumbnail.classList.add('active');
    }
    
    const img = document.createElement('img');
    img.src = image.src;
    img.alt = image.alt;
    img.loading = 'lazy';
    
    thumbnail.appendChild(img);
    
    // Create click handler
    thumbnail.thumbnailClickHandler = function() {
      currentImageIndex = index;
      updateGalleryContent();
    };
    thumbnail.addEventListener('click', thumbnail.thumbnailClickHandler);
    
    container.appendChild(thumbnail);
  });
}

function updateThumbnailActive() {
  const thumbnails = document.querySelectorAll('.thumbnail');
  thumbnails.forEach((thumb, index) => {
    thumb.classList.toggle('active', index === currentImageIndex);
  });
  
  // Scroll active thumbnail into view
  const activeThumbnail = thumbnails[currentImageIndex];
  if (activeThumbnail) {
    activeThumbnail.scrollIntoView({
      behavior: 'smooth',
      block: 'nearest',
      inline: 'center'
    });
  }
}

function previousImage() {
  if (currentImageIndex > 0) {
    currentImageIndex--;
    updateGalleryContent();
  }
}

function nextImage() {
  if (currentAlbum && currentImageIndex < currentAlbum.images.length - 1) {
    currentImageIndex++;
    updateGalleryContent();
  }
}

// Setup on initial DOM load
document.addEventListener('DOMContentLoaded', setupPhotoGallery);

// Re-setup after Astro page transitions
document.addEventListener('astro:after-swap', setupPhotoGallery);

// Also setup immediately if DOM is already ready
if (document.readyState === 'loading') {
  // DOM is still loading, event listeners above will handle it
} else {
  // DOM is already ready, setup immediately
  setupPhotoGallery();
}
</script>
